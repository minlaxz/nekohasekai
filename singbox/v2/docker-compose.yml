services:
    sing-box-v2:
        image: ghcr.io/minlaxz/nekohasekai:singbox-v2
        container_name: sing-box-v2
        restart: unless-stopped
        ports:
            - "8840-8850:8840-8850"
        env_file:
            - .env
        volumes:
            - ./conf:/sing-box/conf
            - public:/sing-box/public
        networks:
            - sing-net

    nginx:
        image: nginx:alpine
        container_name: nginx
        restart: unless-stopped
        depends_on:
            - sing-box-v2
        expose:
          - "80"
        volumes:
            - ./nginx/conf.d:/etc/nginx/conf.d
            - public:/usr/share/nginx/html:ro
        env_file:
            - .env
        networks:
            - sing-net
            - cfnet

volumes:
    public:

networks:
    sing-net:
        driver: bridge
    cfnet:
        external: true